{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"tslib\"","webpack:///external \"mongoose\"","webpack:///external \"inversify-express-utils\"","webpack:///./src/middleware/authMiddleware.ts","webpack:///./src/error/ApiError.ts","webpack:///./src/interfaces/index.ts","webpack:///./src/containerDI/index.ts","webpack:///external \"inversify\"","webpack:///./src/interfaces/types.ts","webpack:///external \"jsonwebtoken\"","webpack:///./src/models/User.ts","webpack:///./src/utils/base.ts","webpack:///external \"reflect-metadata\"","webpack:///./src/models/Friend.ts","webpack:///./src/models/Room.ts","webpack:///./src/main.ts","webpack:///external \"express\"","webpack:///external \"ip\"","webpack:///./src/modules/HttpServer.ts","webpack:///./src/middleware/errorHandlingMiddleware.ts","webpack:///./src/controllers/fileController.ts","webpack:///./src/middleware/file.ts","webpack:///external \"multer\"","webpack:///external \"multer-gridfs-storage\"","webpack:///./src/modules/gridFS.ts","webpack:///external \"gridfs-stream\"","webpack:///./src/interfaces/modules/index.ts","webpack:///./src/controllers/authController.ts","webpack:///external \"bcryptjs\"","webpack:///./src/controllers/userController.ts","webpack:///./src/utils/friends.ts","webpack:///./src/controllers/repetitionController.ts","webpack:///./src/models/Repetitions.ts","webpack:///./src/controllers/dictionariesController.ts","webpack:///./src/models/Dictionary.ts","webpack:///./src/controllers/friendsController.ts","webpack:///external \"socket.io\"","webpack:///./src/modules/WsServer.ts","webpack:///./src/controllers/roomController.ts","webpack:///external \"cors\""],"names":["authMiddleWare","req","_res","next","method","token","headers","authorization","split","ApiError_1","notAuth","decoded","jsonwebtoken_1","verify","process","_user","e","exports","ApiError","status","message","Error","Object","enumerable","get","types_1","myContainer","inversify_1","bind","_unbind","_isBound","_rebind","_unbindAsync","_onActivation","_onDeactivation","interfaces_1","Auth","to","authController_1","inSingletonScope","User","userController_1","Friend","friendsController_1","Dictionary","dictionariesController_1","Repetition","repetitionController_1","Room","roomController_1","DbClient","toConstantValue","mongoose_1","connection","Ws","socket_io_1","Fs","gridFS_1","FileController","fileController_1","WsServer","WsServer_1","registerController","constructor","inversify_express_utils_1","Controller","whenTargetNamed","name","TYPES","Symbol","Server","App","username","type","String","lowercase","unique","required","match","index","email","isProAccount","Boolean","password","profilePicture","avatar","biography","gender","birthday","Number","hobbies","activityDate","Date","language","translatedLanguage","transactions","date","price","currency","exp","friends","Types","ObjectId","ref","timestamps","methods","setPassword","bcryptjs_1","hash","hashedPassword","validPassword","compare","isMatch","generateJWT","sign","idUser","_id","expiresIn","jwtid","generateJWRT","refresh","payload","decode","iat","jti","toAuthJSON","oldToken","refreshToken","parseDictionaryCollection","dictionary","res","values","map","parseDocument","reduce","acc","val","word","model","console","log","deleteDocument","Model","id","response","user","findOneAndRemove","doc","send","responseAllCollection","request","repetition","query","find","collection","patchDocument","oldValue","findOneAndUpdate","value","body","getDataDocument","params","findOne","oldWord","toObject","setDocument","key","documentAlreadyExist","document","save","updateUser","updatedField","userModel","requester","recipient","enums","admin","moderators","users","messages","msg","author","require","ip_1","address","start","server","HttpServer_1","express_1","containerDI_1","listen","connectToDB","HttpServer","framework","dataBase","containerDI","app","load","setConfig","use","json","urlencoded","extended","setErrorConfig","errorHandlingMiddleware_1","connect","exit","build","ErrorHandleMiddleware","err","_req","_next","fs","file","undefined","imgUrl","filename","setHeader","getFileBuffer","buffer","badRequest","result","remove","tslib_1","authMiddleware_1","file_1","single","storage","multer_gridfs_storage_1","url","options","useNewUrlParser","useUnifiedTopology","bucketName","now","originalname","GridFS","fsBucket","once","mongo","GridFSBucket","db","openDownloadStreamByName","files","stream","read","Promise","resolve","reject","chunks","on","data","push","Buffer","concat","modules_1","FS","AuthController","User_1","internal","comparePassword","candidate","UserController","Friend_1","filter","friend","length","toString","findFriends","UserModel","FriendModel","aggregate","localField","foreignField","RepetitionController","Repetitions_1","translatedTo","themes","otherTranslates","translate","synonyms","partsOfSpeech","progress","repeatDay","countRepeatAtStart","repeatAtStart","allMistakes","DictionariesController","Dictionary_1","FriendsController","candidateFriendId","$set","upsert","docA","docB","$push","updateUserA","updateUserB","$pull","ws","roomID","userID","socket","usersTyping","Room_1","roomMsg","emit","newMsg","updateOne","Set","userType","RoomController","room","rooms","friendId","roomId","updatedRoom","joinToRoom","findOneAndDelete"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","module.exports = require(\"tslib\");","module.exports = require(\"mongoose\");","module.exports = require(\"inversify-express-utils\");","import jwt from 'jsonwebtoken'\nimport { ApiError } from '../error/ApiError'\n// import { jwtSecret } from './../../config/default.json'\n\nexport function authMiddleWare(req: any, _res: any, next: any) {\n  if (req.method === \"OPTIONS\") {\n    next()\n  }\n  try {\n    const token = req.headers.authorization.split(' ')[1] // Bearer asfasnfkajsfnjk\n\n    if (!token) {\n      return next(ApiError.notAuth('Token not found'))\n    }\n    const decoded = jwt.verify(token, process.env.jwtSecret || '')\n    req._user = decoded\n    next()\n  } catch (e) {\n    return next(ApiError.notAuth('Token expired'))\n  }\n};\n","export class ApiError extends Error {\n  status: number;\n  private constructor(status: number, message: string) {\n    super();\n    this.status = status\n    this.message = message\n  }\n\n  static badRequest(message: string) {\n    return new ApiError(404, message)\n  }\n\n  static internal(message: string) {\n    return new ApiError(500, message)\n  }\n\n  static forbidden(message: string) {\n    return new ApiError(403, message)\n  }\n\n  static notAuth(message: string) {\n    return new ApiError(401, message)\n  }\n}","import cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport { TYPES } from \"./types\";\n\nexport type Cors = (\n  req: cors.CorsRequest,\n  res: {\n    statusCode?: number | undefined;\n    setHeader(key: string, value: string): any;\n    end(): any;\n  },\n  next: (err?: any) => any\n) => void\n\nexport interface DB<T, O = any, C = any> {\n  connect: (uri: string, options?: O, callback?: C) => Promise<T>\n}\n\nexport interface IServer {\n  connectToDB: () => Promise<void>;\n  listen: () => void;\n  useRouter: () => void;\n}\n\nexport interface IFileController {\n  uploadPhoto: (req: any, res: any, next: any) => void\n  getPhoto: (req: any, res: any, next: any) => void\n  deletePhoto: (req: any, res: any, next: any) => void\n}\n\nexport type DbClient = mongoose.Connection;\n\nexport { TYPES }","import { Container, ContainerModule, interfaces } from \"inversify\";\nimport mongoose, { Types } from \"mongoose\";\n// import { Server } from \"../../server\";\nimport { FileController } from \"../controllers/fileController\";\nimport { GridFS } from \"../modules/gridFS\";\n// import { FS } from \"../controllers/intefaces\";\nimport { Cors, DB, DbClient, IFileController, IServer, TYPES } from \"../interfaces\";\nimport { TYPE } from \"inversify-express-utils\";\nimport { Auth, AuthController, authController } from \"../controllers/authController\";\nimport { UserController } from \"../controllers/userController\";\nimport { RepetitionController } from \"../controllers/repetitionController\";\nimport { DictionariesController } from \"../controllers/dictionariesController\";\nimport { FS } from \"../interfaces/modules\";\nimport { FriendsController } from \"../controllers/friendsController\";\nimport {Server as IOServer} from 'socket.io'\nimport { WsServer } from \"../modules/WsServer\";\nimport { RoomController } from \"../controllers/roomController\";\n\nconst myContainer = new Container();\n\nexport const mainModule = new ContainerModule(\n  (\n    bind: interfaces.Bind,\n    _unbind: interfaces.Unbind,\n    _isBound: interfaces.IsBound,\n    _rebind: interfaces.Rebind,\n    _unbindAsync: interfaces.UnbindAsync,\n    _onActivation: interfaces.Container[\"onActivation\"],\n    _onDeactivation: interfaces.Container[\"onDeactivation\"]\n  ) => {\n\n    // registerController(bind, AuthController)\n\n    bind<Auth>(TYPES.Auth).to(AuthController).inSingletonScope()\n    bind<UserController>(TYPES.User).to(UserController).inSingletonScope()\n    bind<FriendsController>(TYPES.Friend).to(FriendsController).inSingletonScope()\n    bind<DictionariesController>(TYPES.Dictionary).to(DictionariesController).inSingletonScope()\n    bind<RepetitionController>(TYPES.Repetition).to(RepetitionController).inSingletonScope()\n    bind<RoomController>(TYPES.Room).to(RoomController).inSingletonScope()\n\n    bind<DbClient>(TYPES.DbClient).toConstantValue(mongoose.connection)\n\n    bind<typeof IOServer>(TYPES.Ws).toConstantValue(IOServer)\n    bind<FS>(TYPES.Fs).to(GridFS).inSingletonScope()\n    bind<IFileController>(TYPES.FileController).to(FileController).inSingletonScope()\n    // bind<Container>(TYPES.Container).toConstantValue(myContainer)\n    bind<WsServer>(TYPES.WsServer).to(WsServer).inSingletonScope()\n\n  }\n);\n\n\nfunction registerController<T>(\n  bind: interfaces.Bind,\n  constructor: interfaces.Newable<T>\n) {\n  bind<T>(TYPE.Controller)\n    .to(constructor)\n    .whenTargetNamed(constructor.name);\n}\n\nexport { myContainer }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import { Container, Inject, Service } from 'typedi';\n// DI with typedi\n// const container = Container.of();\n\n// const fs = new GridFS(mongoose.connection);\n// // const fileController = new FileController();\n\n// container.set(\"fs\", fs);\n// // container.set(\"fileSystem\", fileSystem);\n\n// const fileController = container.get(FileController);","module.exports = require(\"inversify\");","const TYPES = {\n  Fs: Symbol.for(\"Fs\"),\n  FileController: Symbol.for(\"FileController\"), \n  Server: Symbol.for(\"Server\"),\n  App: Symbol.for(\"App\"),\n  DbClient: Symbol(\"DbClient\"),\n  Ws: Symbol(\"Ws\"),\n  WsServer: Symbol(\"WsServer\"),\n  Repetition: Symbol('Repetition'),\n  Dictionary: Symbol('Dictionary'),\n  User: Symbol('User'),\n  Friend: Symbol('Friend'),\n  Auth: Symbol('Auth'),\n  Room: Symbol('Room')\n  // Container: Symbol('Container'),\n};\n\nexport { TYPES };","module.exports = require(\"jsonwebtoken\");","\nimport { Schema, model, Types } from 'mongoose'\nimport bcrypt from 'bcryptjs'\nimport jwt, { JwtPayload } from 'jsonwebtoken'\n// import { jwtSecret } from './../../config/default.json'\n\nexport const userSchema = new Schema<UserSchema, {}, IUserMethods>({\n  username: { type: String, lowercase: true, unique: true, required: [true, \"can't be blank\"], match: [/^[a-zA-Z0-9]+$/, 'is invalid'], index: true },\n  email: { type: String, lowercase: true, unique: true, required: [true, \"can't be blank\"], match: [/\\S+@\\S+\\.\\S+/, 'is invalid'], index: true },\n  isProAccount: { type: Boolean, default: false },\n  password: String,\n  profilePicture: String,\n  avatar: String,\n  biography: String,\n  gender: { type: String, enum: [\"male\", \"female\"] },\n  birthday: Number,\n  hobbies: String,\n  activityDate: Date,\n  language: {\n    type: String,\n    required: true\n  },\n  translatedLanguage: {\n    type: String,\n    required: true\n  },\n  transactions: [{\n    date: Number,\n    price: Number,\n    currency: String,\n    exp: Number,\n  }],\n  friends: [{ type: Schema.Types.ObjectId, ref: 'Friends'}]\n}, { timestamps: true })\n\nexport type UserSchema = {\n  _id?: Types.ObjectId;\n  username: string;\n  email: string;\n  isProAccount?: boolean;\n  password?: string;\n  profilePicture?: string;\n  avatar: string;\n  biography?: string;\n  gender?: 'male' | 'female';\n  birthday?: number;\n  hobbies?: string;\n  activityDate?: Date;\n  language: string;\n  translatedLanguage: string;\n  transactions?: {\n    date: number;\n    price: number;\n    currency: string;\n    exp: number;\n  }[],\n  friends: string[]\n}\n\ninterface IUser {\n  username: string;\n  email: string;\n  isProAccount: boolean;\n  token: string;\n  refreshToken: string;\n}\n\ninterface IUserMethods {\n  setPassword(password: string): Promise<void>;\n  validPassword(password: string): Promise<boolean>;\n  generateJWT(): string;\n  generateJWRT(token: string): string;\n  toAuthJSON(tokenOuter?: string): IUser\n}\n//mongo88\nuserSchema.methods.setPassword = async function (password: string) {\n  const hashedPassword = await bcrypt.hash(password, 12)\n  this.password = hashedPassword\n}\n\nuserSchema.methods.validPassword = async function (password: string): Promise<boolean> {\n  const isMatch = await bcrypt.compare(password, this.password)\n  return isMatch\n}\n\nuserSchema.methods.generateJWT = function () {\n  const token = jwt.sign(\n    {\n      idUser: this._id,\n    },\n    process.env.jwtSecret || '',\n    {\n      expiresIn: '1d',\n      jwtid: '1'\n    }\n  )\n\n  return token\n}\n\nuserSchema.methods.generateJWRT = function refresh(token: string) {\n  // const token = this.toAuthJSON().token\n  const payload = jwt.decode(token) as JwtPayload;\n\n\n  delete payload.exp;\n  delete payload.iat;\n  delete payload.jti\n  return jwt.sign(payload, process.env.jwtSecret || '', { expiresIn: '2d', jwtid: '2' });\n\n  // delete payload.nbf;\n  // delete payload.jti; //We are generating a new token, if you are using jwtid during signing, pass it in refreshOptions\n  // const localJwtSignOptions = Object.assign({}, { jwtid: refreshOptions.jwtid }, {expiresIn: '1h'});\n  // The first signing converted all needed options into claims, they are already in the payload\n}\n\nuserSchema.methods.toAuthJSON = function (oldToken?: string) {\n  const { username, email, isProAccount, _id, avatar, profilePicture, language, translatedLanguage } = this\n  const token = oldToken || this.generateJWT();\n  return {\n    username,\n    email,\n    isProAccount,\n    token,\n    avatar,\n    profilePicture,\n    refreshToken: this.generateJWRT(token),\n    idUser: _id,\n    language,\n    translatedLanguage\n  }\n}\n\nexport const User = model('User', userSchema)\n","import mongoose, { Model } from \"mongoose\";\nimport { UserSchema } from \"../models/User\";\n\n\nexport function parseDictionaryCollection(dictionary: any) {\n\n\n  const res = Object.values(dictionary).map(parseDocument)\n\n  // const resToObj = res.reduce(arrayToObject, {})\n  // \n  // await writeFile(`${PATH_DATA}repetitions.json`, JSON.stringify(resToObj, null, 2));\n  return res.reduce((acc, val) => ({ ...acc, [val.word]: val }), {});\n}\n\nexport function parseDocument(model: any) {\n\n  try {\n    return {...model.get('value'), _id: model.get('_id')}\n  } catch (e) {\n    console.log(e)\n  }\n}\n\nexport async function deleteDocument(Model: Model<{}>, id: string, response: any, user: string) {\n  try {\n\n    const doc = await Model.findOneAndRemove({ _id: id, user })\n    return response.send(parseDocument(doc));\n  } catch (err) {\n    return console.log(err);\n  } \n}\n\nexport const responseAllCollection = async (Model: Model<{}>, response: any, request: any, repetition = false) => {\n  const { idUser } = request._user;\n  const {language, translatedLanguage} = request.query\n \n  try {\n    let collection\n    if (repetition) {\n      collection = await Model.find({ user: idUser, 'value.language': [language, translatedLanguage], 'value.translatedTo': [language, translatedLanguage] })\n        // .find({'value.language': translatedLanguage, 'value.translatedTo': language })\n    } else {\n      collection = await Model.find({ user: idUser, 'value.language': language, 'value.translatedTo': translatedLanguage })\n\n    }\n    \n    return response.send(parseDictionaryCollection(collection))\n  } catch (err) {\n    return console.log(err);\n  }\n\n}\n\nexport async function patchDocument(Model: Model<{}>, id: string, oldValue: any, request: any, response: any) {\n  const { idUser } = request._user;\n\n  try {\n    const res = await Model.findOneAndUpdate({ _id: id, user: idUser }, { value: { ...oldValue, ...request.body } }, { new: true });\n   return  response.send(parseDocument(res));\n  } catch(err) {\n    return console.log(err);\n  }\n\n}\n\nexport async function getDataDocument<T>(request: any, Model: Model<T>) {\n  const { id } = request.params;\n  const { idUser } = request._user;\n\n  const oldWord = await Model.findOne({ _id: id, user: idUser })\n  const oldValue = oldWord?.toObject().value || {}\n\n  return { id, oldValue }\n}\n\nexport async function setDocument(Model: Model<{}>, request: any, response: any) {\n  const { idUser } = request._user;\n\n  const documentAlreadyExist = await Model.findOne({ key: request.body.word, user: idUser })\n\n  if (documentAlreadyExist) {\n    return response.status(404).send()\n  }\n\n  const document = new Model({ key: request.body.word, value: request.body, user: new mongoose.Types.ObjectId(idUser) });\n\n \n  try {\n    await document.save()\n    return response.send(parseDocument(document));\n  } catch (error) {\n    return console.log(error);\n  }\n  \n}\n\nexport async function updateUser(request: any, Model: Model<UserSchema>, updatedField: {[key: string]: string}) {\n\n  const { idUser } = request._user;\n  const userModel = await Model.findOne({ _id: idUser })\n \n  \n  return await Model.findOneAndUpdate({ _id: idUser }, { ...userModel?.toObject(), ...updatedField}, { new: true })\n} ","module.exports = require(\"reflect-metadata\");","\nimport { Schema, model } from 'mongoose'\n\nexport const friendsSchema = new Schema({\n  requester: { type: Schema.Types.ObjectId, ref: 'User' },\n  recipient: { type: Schema.Types.ObjectId, ref: 'User' },\n  status: {\n    type: Number,\n    enums: [\n      0,    //'add friend',\n      1,    //'requested',\n      2,    //'pending',\n      3,    //'friends'\n    ]\n  }\n}, { timestamps: true })\n\nexport const Friend = model('Friends', friendsSchema)\n","\nimport { Schema, model } from 'mongoose'\n\nexport const roomSchema = new Schema({\n  admin: { type: Schema.Types.ObjectId, ref: 'User' },\n  moderators: [{ type: Schema.Types.ObjectId, ref: 'User' }],\n  users: [{ type: Schema.Types.ObjectId, ref: 'User' }],\n  messages: [{\n    msg: String,\n    author: Schema.Types.ObjectId,\n    date: Date,\n  }],\n}, { timestamps: true })\n\nexport const Room = model('Rooms', roomSchema)\n","import \"reflect-metadata\";\nimport express, { Express } from \"express\";\n\nimport ip from \"ip\";\nimport mongoose, { Model } from 'mongoose'\nimport { HttpServer } from \"./modules/HttpServer\";\nimport { myContainer } from \"./containerDI\"; \n\nconsole.log('local ip my computer: ', ip.address());\n \n\nasync function start() {\n  \n  const server = new HttpServer<typeof mongoose>(express, mongoose, myContainer)\n  console.log('used dependency injection')\n\n  server.listen()\n  await server.connectToDB()\n  \n}\n\n(async () => {\n\n  await start();\n})();\n\n","module.exports = require(\"express\");","module.exports = require(\"ip\");","import express, { Express, Router } from \"express\";\n// import { router } from \"../routes\";\nimport { ErrorHandleMiddleware } from \"../middleware/errorHandlingMiddleware\";\n// import { mongoURI, port } from './../../config/default.json'\nimport { Cors, DB, IFileController, IServer, TYPES } from \"../interfaces\";\nimport { Container } from \"inversify\";\nimport { InversifyExpressServer } from \"inversify-express-utils\";\nimport { mainModule } from \"../containerDI\";\nimport cors, { CorsRequest } from 'cors'\nimport * as http from \"http\";\n\nexport class HttpServer<T, O = any, C = any> implements IServer {\n  private app!: InversifyExpressServer\n  constructor(\n    private framework: typeof express,\n    private dataBase: DB<T, O, C>,\n    private containerDI: Container\n  ) {\n    console.log(1)\n    this.app = new InversifyExpressServer(containerDI)\n    containerDI.load(mainModule)\n    console.log(2)\n    this.app.setConfig((app) => {\n      app.use(cors())\n      app.use(this.framework.json())\n      app.use(this.framework.urlencoded({ extended: false }))\n    })\n    console.log(3)\n    this.app.setErrorConfig((app) => {\n      app.use(ErrorHandleMiddleware)\n    })\n    console.log(4)\n    \n  }\n\n  async connectToDB() {\n    try {\n      console.log(7)\n      await this.dataBase.connect(process.env.mongoURI || '')\n      console.log(8)\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log('Server error', e.message)\n      }\n      process.exit(1)\n    }\n  }\n\n  useRouter() {\n    // this.app.use('/api', this.router)\n  }\n\n  listen() {\n    console.log(5)\n    const build =  this.app.build()\n    // this.app.build.\n    console.log(6)\n    const app = build.listen(process.env.PORT || '3000');\n    // build.on('request', app as any)\n    console.log(`Application listening on port ${process.env.PORT}...`);\n\n    this.containerDI.bind<http.Server>(TYPES.App).toConstantValue(app);\n   \n  }\n}\n","import { ApiError } from './../error/ApiError'\n\nexport function ErrorHandleMiddleware (err: any, _req: any, res: any, _next: any) {\n   \n    \n    if (err instanceof ApiError) {\n      \n        return res.status(err.status).json({message: err.message})\n    }\n    \n    return res.status(500).json({message: \"Error!\"})\n}","import ip from \"ip\";\n// import { Fs, GridFS } from \"./gridFS\";\nimport { ApiError } from \"../error/ApiError\";\nimport { FileSchema, FS } from \"./intefaces\";\n// import { gridFs } from \"./gridFS\";\nimport { NextFunction } from \"express\";\nimport 'reflect-metadata';\nimport { injectable, inject } from \"inversify\";\nimport { TYPES } from \"./../interfaces/types\";\nimport { IFileController } from \"../interfaces\";\nimport { BaseHttpController, controller, httpDelete, httpGet, httpPost } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { upload } from \"../middleware/file\";\n\n// @injectable()\n@controller('/api/file')\nexport class FileController implements IFileController {\n  constructor(@inject(TYPES.Fs) private fs: FS<FileSchema>) { }\n\n  @httpPost('/upload', authMiddleWare, upload.single('file'))\n  async uploadPhoto(req: any, res: any) {\n    // res.\n\n    if (req.file === undefined) return res.send(\"you must select a file.\");\n\n    // const imgUrl = `https://build-wheat-rho.vercel.app/api/file/${req.file.filename}`\n    const imgUrl = `https://wordsback.herokuapp.com/api/file/${req.file.filename}`\n\n    // `${this.URL}/avatar/${req.file.filename}`;\n    return res.send(imgUrl);\n  }\n\n\n  @httpGet('/:filename')\n  async getPhoto(req: any, res: any, next: NextFunction) {\n\n    try {\n\n      const file: any = await this.fs.findOne(req.params.filename);\n      if (file) {\n        res.setHeader('content-type', 'application/octet-stream');\n        const buffer = await this.fs.getFileBuffer(file.filename)\n        return res.send(buffer)\n      }\n      return next(ApiError.badRequest('photo not a found'))\n    } catch (error) {\n\n      return res.send('not found');\n    }\n  }\n\n  @httpDelete('/:filename', authMiddleWare)\n  async deletePhoto(req: any, res: any, next: NextFunction) {\n    try {\n\n      const result = await this.fs.findOne(req.params.filename);\n      if (result?._id) {\n        const remove = this.fs.delete(result._id)\n        return res.send(\"success\");\n      }\n      return next(ApiError.badRequest('photo not a found'))\n      // const removeFile = await this.gfs.files.findOneAndDelete({ filename: req.params.filename});\n      // const removeChunk = await this.gfs.collection('photos.chunks').findOneAndDelete({files_id: result?._id})\n\n    } catch (error) {\n      console.log(error);\n      res.send(\"An error occur.\");\n    }\n  }\n}\n\n// export const fileController = new FileController(gridFs)\n\n\n// export const fileController = container.registerSingleton<FileController>()\n","\nimport mongoose from 'mongoose';\nimport multer from 'multer'\nimport { GridFsStorage } from 'multer-gridfs-storage'\n// import { mongoURI, port } from './../../config/default.json'\nimport GridFsStream from \"gridfs-stream\";\n\n// const conn = mongoose.createConnection(mongoURI);\n// const conn = mongoose.connection;\n// //Init gfs \n// let gfs; \n// conn.once('open', ()=>{\n//     gfs = GridFsStream(conn.db, mongoose.mongo);\n//     gfs.collection('photos');\n// })\n\n// export function initFileMiddleWare(db: typeof mongoose) {\n//     const storage = new GridFsStorage({\n//         url: `${mongoURI}/English`,\n//         options: { useNewUrlParser: true, useUnifiedTopology: true },\n//         file: (_req, file) => {\n//             const match = [\"image/png\", \"image/jpeg\"];\n//             \n//             if (match.indexOf(file.mimetype) === -1) {\n//                 const filename = `${Date.now()}-any-name-${file.originalname}`;\n//                 return filename;\n//             }\n\n//             return {\n//                 bucketName: \"photos\",\n//                 filename: `${Date.now()}-any-name-${file.originalname}`,\n//             };\n//         },\n//     });\n// }\n\nconst storage = new GridFsStorage({\n  url: process.env.mongoURI || '',\n  options: { useNewUrlParser: true, useUnifiedTopology: true },\n  file: (_req, file) => {\n    const match = [\"image/png\", \"image/jpeg\"];\n\n    // if (match.indexOf(file.mimetype) === -1) {\n    //     const filename = `${Date.now()}-any-name-${file.originalname}`;\n    //     return filename;\n    // }\n\n    return {\n      bucketName: \"photos\",\n      filename: `${Date.now()}-asset-${file.originalname}`,\n    };\n  },\n});\n\nexport const upload = multer({ storage });","module.exports = require(\"multer\");","module.exports = require(\"multer-gridfs-storage\");","import mongoose, { InferId } from 'mongoose';\nimport GridFsStream, { } from \"gridfs-stream\";\nimport {\n  FileSchema,\n  //  FS\n} from '../controllers/intefaces';\nimport { inject, injectable } from 'inversify';\nimport { TYPES } from '../interfaces';\nimport { FS } from './../interfaces/modules'\n\n// @injectable()\nexport class GridFS extends FS<FileSchema, mongoose.Connection>{\n  private fs!: GridFsStream.Grid\n  private fsBucket!: any\n  // private conn!: any\n\n  constructor(protected connection: mongoose.Connection) {\n    super(connection)\n    connection.once('open', () => {\n\n      this.fsBucket = new mongoose.mongo.GridFSBucket(connection.db, {\n        bucketName: 'photos'\n      })\n\n      this.fs = GridFsStream(connection.db, mongoose.mongo);\n      this.fs.collection('photos');\n    })\n  }\n\n  protected openDownloadStreamByName(filename: string) {\n    return this.fsBucket.openDownloadStreamByName(filename)\n  }\n\n  async findOne(filename: string) {\n    return await this.fs.files.findOne<FileSchema>({ filename })\n  }\n\n  protected delete(id: InferId<FileSchema>) {\n    return this.fsBucket.delete(id)\n  }\n\n  protected async getFileBuffer(filename: string) {\n    const stream = this.openDownloadStreamByName(filename);\n    stream.read();\n    \n    return new Promise<Buffer>((resolve, reject) => {\n      const chunks: any = []\n      stream.on('data', (data: any) => {\n        chunks.push(data);\n      });\n      stream.on('end', () => {\n        const data = Buffer.concat(chunks);\n        \n\n        resolve(data);\n      });\n      stream.on('error', (err: any) => {\n        reject(err);\n      });\n    });\n  }\n}\n\n// const c = new GridFS(new mongoose.Connection)\n\n// c\n// export const gridFs = new GridFS(mongoose.connection)\n","module.exports = require(\"gridfs-stream\");","import { inject, injectable } from \"inversify\";\nimport { TYPES } from \"../types\";\n\n@injectable()\nexport abstract class FS<T1 = any, T2 = any, T3 = any> {\n  // @inject(TYPES.DbClient) protected abstract conn: T2\n  constructor(@inject(TYPES.DbClient) protected connection: T2) { }\n\n  protected abstract getFileBuffer(filename: string): Promise<Buffer>;\n  protected abstract findOne(filename: string): Promise<T1 | null>;\n  protected abstract openDownloadStreamByName(filename: string): T3;\n  protected abstract delete(id: T3): T3;\n}","import { ApiError } from \"../error/ApiError\";\nimport { Dictionary, TranslatedDictionary } from \"../models/Dictionary\";\nimport { Repetition } from \"../models/Repetitions\";\nimport { User } from \"../models/User\";\nimport { deleteDocument, getDataDocument, patchDocument, responseAllCollection, setDocument } from \"../utils/base\";\nimport jwt, { JwtPayload } from 'jsonwebtoken'\n// import { jwtSecret } from './../../config/default.json'\nimport { controller, httpPost, httpGet } from \"inversify-express-utils\";\nimport { inject, injectable } from \"inversify\";\n\nexport interface Auth {\n  login(...any: any): Promise<any>\n  registration(...any: any): Promise<any>\n  refresh(...any: any): Promise<any>\n  getUser(...any: any): Promise<any>\n}\n\n\n@controller(\"/api/auth\")\nexport class AuthController implements Auth {\n\n  // @inject() public _actorRepository: ActorRepository;\n\n  @httpPost('/login')\n  async login(req: any, res: any, next: any) {\n    const { password, username } = req.body\n    const user = await User.findOne({ username })\n\n    if (!user) {\n      return next(ApiError.internal('User not a found'))\n    }\n    let comparePassword = await user.validPassword(password);\n    if (!comparePassword) {\n      return next(ApiError.internal('Write correct password'))\n    }\n    const json = user.toAuthJSON()\n\n    return res.json(json)\n  }\n  @httpPost('/registration')\n  async registration(req: any, res: any, next: any) {\n    const { email, password, username } = req.body\n    // if (!email || !password) {\n    //   return next(ApiError.badRequest('Некорректный email или password'))\n    // }\n    const candidate = await User.findOne({ email })\n    if (candidate) {\n      return next(ApiError.badRequest('The User now exist'))\n    }\n\n    const user = new User({\n      username,\n      email,\n      language: 'en',\n      translatedLanguage: 'ua'\n    })\n\n    await user.setPassword(password)\n    await user.save()\n    const json = user.toAuthJSON()\n\n    return res.json(json)\n  }\n\n  @httpGet('/getUser/:refreshToken')\n  async refresh(req: any, res: any, next: any) {\n    try {\n      const { refreshToken } = req.params\n      const decoded = jwt.verify(refreshToken, process.env.jwtSecret || '') as JwtPayload\n\n      const user = await User.findOne({ _id: decoded?.idUser })\n      if (!user) {\n        return next(ApiError.internal('User not a found'))\n      }\n\n      const json = user.toAuthJSON(refreshToken)\n\n      return res.json(json)\n    } catch {\n      return next(ApiError.notAuth('Refresh token expired'))\n    }\n  }\n\n  @httpGet('/refresh/:token')\n  async getUser(req: any, res: any, next: any) {\n\n    try {\n      const { token } = req.params\n      const decoded = jwt.verify(token, process.env.jwtSecret || '')\n\n\n      if (typeof decoded !== 'string') {\n        const user = await User.findOne({ _id: decoded?.idUser })\n        if (!user) {\n          return next(ApiError.internal('User not a found'))\n        }\n\n        const json = user.toAuthJSON(token)\n\n        return res.json(json)\n      }\n      return next(ApiError.internal('Can\\'t decode token'))\n    } catch (e) {\n      return next(ApiError.notAuth('Token expired'))\n    }\n  }\n}\n\nexport const authController = new AuthController()\n","module.exports = require(\"bcryptjs\");","\nimport { User } from \"../models/User\";\nimport { updateUser } from \"../utils/base\";\n\n\nimport { controller, httpPatch, httpGet } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { Friend } from \"../models/Friend\"; \nimport { findFriends } from \"../utils/friends\";\n\n@controller(\"/api/user\", authMiddleWare)\nexport class UserController {\n\n  @httpGet('/friends')\n  async friends(request: any, response: any) {\n    const { idUser } = request._user;\n     \n    const users = await findFriends(User, Friend, idUser)\n\n    const friends = users.filter(friend => friend.match.length)\n    \n\n    return response.send(friends)\n  }\n\n  @httpGet('/friendsCandidates')\n  async friendsCandidates(request: any, response: any) {\n    const { idUser } = request._user;\n \n    const users = await findFriends(User, Friend, idUser)\n    \n    const friends = users.filter(friend => !friend.match.length && friend._id.toString() !== idUser)\n    \n\n    return response.send(friends)\n  }\n \n  @httpPatch('/patchActivityDate')\n  async patchActivityDate(request: any, response: any) {\n\n    const { idUser } = request._user;\n\n    const userModel = await User.findOne({ _id: idUser })\n    const activityDate = new Date()\n\n    await User.findOneAndUpdate({ _id: idUser }, { ...userModel?.toObject(), activityDate }, { new: true })\n    return response.status(204).send()\n  }\n\n  @httpPatch('/patchAvatar')\n  async patchAvatar(request: any, response: any) {\n    const { avatar } = request.body\n\n    const updatedField = {\n      avatar\n    }\n\n    await updateUser(request, User, updatedField)\n\n    return response.status(204).send()\n  }\n\n  @httpPatch('/patchProfilePicture')\n  async patchProfilePicture(request: any, response: any) {\n    const { profilePicture } = request.body\n\n    const updatedField = {\n      profilePicture\n    }\n\n    await updateUser(request, User, updatedField)\n\n    return response.status(204).send()\n  }\n\n  @httpPatch('/patchTranslatedLanguage')\n  async patchLanguage(request: any, response: any) {\n    const { translatedLanguage } = request.body\n\n    const updatedField = {\n      translatedLanguage\n    }\n\n    const data = await updateUser(request, User, updatedField)\n    \n    return response.status(204).send(data?.toObject().language)\n  }\n\n  @httpPatch('/patchLanguage')\n  async patchTranslatedLanguage(request: any, response: any) {\n    const { language } = request.body\n\n    const updatedField = {\n      language\n    }\n\n    const data = await updateUser(request, User, updatedField)\n    \n    return response.status(204).send(data?.toObject().translatedLanguage)\n  }\n}\n\n\n// async function toBuffer (avatar: string)  {\n\n//  } \n\n\nexport const userController = new UserController()\n","import mongoose, { Model } from \"mongoose\";\n\nexport async function findFriends<T, T1, T2>(UserModel: Model<T, T1, T2>, FriendModel: Model<{}>, id: string) {\n  return UserModel.aggregate([\n    {\n      \"$lookup\": {\n        \"from\": FriendModel.collection.name,\n        localField: \"friends\",\n        foreignField: \"_id\",\n        \"let\": { \"friends\": \"$friends\" },\n        \"as\": \"match\",\n        \"pipeline\": [\n          {\n            \"$match\": {\n              \"recipient\": new mongoose.Types.ObjectId(id),\n              \"$expr\": { \"$in\": [\"$_id\", \"$$friends\"] }\n            }\n          }\n        ],\n      }\n    }\n  ])\n}","import { controller, httpGet, httpPatch, httpPost } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { Dictionary, TranslatedDictionary } from \"../models/Dictionary\";\nimport { Repetition } from \"../models/Repetitions\";\nimport { deleteDocument, getDataDocument, patchDocument, responseAllCollection, setDocument } from \"../utils/base\";\n\n@controller('/api/repetitions', authMiddleWare) \nexport class RepetitionController {\n\n  @httpGet('/repetitions')\n  async getRepetitions(request: any, response: any) {\n \n    return await responseAllCollection(Repetition, response, request, true)\n  }\n\n  @httpPatch('/patchRepetition/:id')\n  async patchRepetition(request: any, response: any) {\n    const {id, oldValue} = await getDataDocument(request, Repetition)\n\n   return await patchDocument(Repetition, id, oldValue, request, response)\n  }\n   \n  @httpPost('/setRepetition')\n  async setRepetition(request: any, response: any) {\n    \n    return await setDocument(Repetition, request, response)\n  }\n  \n}\n\nexport const repetitionController = new RepetitionController()\n","\nimport { Schema, model } from 'mongoose'\n\nexport const repetitionSchema = new Schema({\n  key: String,\n  user: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  value: {\n    language: { type: String, required: true },\n    translatedTo: { type: String, required: true },\n    word: { type: String, required: true },\n    themes: {\n      type: Object,\n      required: false\n    },\n    otherTranslates: {\n      type: Object,\n      required: false\n    },\n    translate: { type: String, required: true },\n    synonyms: { type: Object, required: true },\n    partsOfSpeech: {\n      type: Object,\n      required: true\n    },\n    progress: {\n      type: [Object],\n      required: true\n    },\n    repeatDay: {\n      type: Number,\n      required: true\n    },\n    countRepeatAtStart: {\n      type: Number,\n      required: true\n    },\n    repeatAtStart: {\n      type: Boolean,\n      required: true\n    },\n    allMistakes: {\n      type: Number,\n      required: true\n    }\n  }\n},{ timestamps: true })\n\n\nexport const Repetition = model('Repetition', repetitionSchema)\n","import { controller, httpDelete, httpGet, httpPatch, httpPost } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { Dictionary, StaticDictionary, StaticTranslatedDictionary, TranslatedDictionary } from \"../models/Dictionary\";\nimport { deleteDocument, getDataDocument, patchDocument, responseAllCollection, setDocument } from \"../utils/base\";\n\n@controller('/api/dictionaries', authMiddleWare)\nexport class DictionariesController {\n\n  @httpDelete('/dictionary/:id')\n  async deleteWord(request: any, response: any) {\n    const { id } = request.params;\n    const { idUser } = request._user;\n    \n    return deleteDocument(Dictionary, id, response, idUser)\n  }\n\n  @httpDelete('/translatedDictionary/:id')\n  async deleteTranslatedWord(request: any, response: any) {\n    const { id } = request.params;\n    const { idUser } = request._user;\n\n   return  deleteDocument(TranslatedDictionary, id, response, idUser)\n  }\n  \n  @httpGet('/dictionary')\n  async getDictionary(request: any, response: any) {\n \n    await responseAllCollection(Dictionary, response, request)\n  }\n\n  @httpGet('/staticDictionary')\n  async getStaticDictionary(request: any, response: any) {\n \n    return await responseAllCollection(StaticDictionary, response, request)\n  }\n\n  @httpGet('/staticTranslatedDictionary')\n  async getStaticTranslatedDictionary(request: any, response: any) {\n \n    return await responseAllCollection(StaticTranslatedDictionary, response, request)\n  }\n\n  @httpGet('/translatedDictionary')\n  async getTranslatedDictionary(request: any, response: any) {\n \n    return  await responseAllCollection(TranslatedDictionary, response, request)\n  }\n\n  @httpPatch('/patchDictionary/:id')\n  async patchDictionary(request: any, response: any) {\n    const { id, oldValue } = await getDataDocument(request, Dictionary)\n\n    return await patchDocument(Dictionary, id, oldValue, request, response)\n  }\n\n\n  @httpPatch('/patchStaticDictionary/:id')\n  async patchStaticDictionary(request: any, response: any) {\n    const { id, oldValue } = await getDataDocument(request, StaticDictionary)\n\n    return await patchDocument(StaticDictionary, id, oldValue, request, response)\n  }\n\n\n  @httpPatch('/patchTranslatedDictionary/:id')\n  async patchTranslatedDictionary(request: any, response: any) {\n    const { id, oldValue } = await getDataDocument(request, TranslatedDictionary)\n\n    return await patchDocument(TranslatedDictionary, id, oldValue, request, response)\n  }\n\n\n  @httpPatch('/patchStaticTranslatedDictionary/:id')\n  async patchStaticTranslatedDictionary(request: any, response: any) {\n    const { id, oldValue } = await getDataDocument(request, StaticTranslatedDictionary)\n\n    return await patchDocument(StaticTranslatedDictionary, id, oldValue, request, response)\n  }\n\n  @httpPost('/setDictionary')\n  async setDictionary(request: any, response: any) {\n   return  await setDocument(Dictionary, request, response)\n  }\n\n\n  @httpPost('/setTranslatedDictionary')\n  async setTranslatedDictionary(request: any, response: any) {\n    return await setDocument(TranslatedDictionary, request, response)\n  }\n\n\n  @httpPost('/setStaticDictionary')\n  async setStaticDictionary(request: any, response: any) {\n    return await setDocument(StaticDictionary, request, response)\n  }\n\n  @httpPost('/setStaticTranslatedDictionary')\n  async setStaticTranslatedDictionary(request: any, response: any) {\n    return await setDocument(StaticTranslatedDictionary, request, response)\n  }\n}\n\nexport const dictionariesController = new DictionariesController()\n","\nimport { Schema, model } from 'mongoose'\n\nexport const dictionarySchema = new Schema({\n  key: String,\n  user: {\n    type: Schema.Types.ObjectId,\n    ref: 'User'\n  },\n  value: {\n    language: { type: String, required: true },\n    translatedTo: { type: String, required: true },\n    word: { type: String, required: true },\n    themes: {\n      type: Object,\n      required: false\n    },\n    otherTranslates: {\n      type: Object,\n      required: false\n    },\n    translate: { type: String, required: true },\n    synonyms: { type: Object, required: true },\n    partsOfSpeech: {\n      type: Object,\n      required: true\n    }\n  }\n},{ timestamps: true })\n\nexport const Dictionary = model('Dictionary', dictionarySchema)\nexport const StaticDictionary = model('StaticDictionary', dictionarySchema)\nexport const TranslatedDictionary = model('TranslatedDictionary', dictionarySchema)\nexport const StaticTranslatedDictionary = model('StaticTranslatedDictionary', dictionarySchema)\n","\nimport { User } from \"../models/User\";\nimport { updateUser } from \"../utils/base\";\n\n\nimport { controller, httpPatch, httpGet } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { Friend } from \"../models/Friend\";\n\n@controller(\"/api/friends\", authMiddleWare)\nexport class FriendsController {\n\n  @httpGet('/requestBeFriend')\n  async requestBeFriend(request: any, response: any) {\n\n    const { idUser } = request._user;\n    const { candidateFriendId } = request.query;\n    \n    const docA = await Friend.findOneAndUpdate(\n      { requester: idUser, recipient: candidateFriendId },\n      { $set: { status: 1 } },\n      { upsert: true, new: true }\n    )\n    const docB = await Friend.findOneAndUpdate(\n      { recipient: idUser, requester: candidateFriendId },\n      { $set: { status: 2 } },\n      { upsert: true, new: true }\n    )\n    const updateUserA = await User.findOneAndUpdate(\n      { _id: idUser },\n      { $push: { friends: docA._id } }\n    )\n    const updateUserB = await User.findOneAndUpdate(\n      { _id: candidateFriendId },\n      { $push: { friends: docB._id } }\n    )\n    \n    return response.status(204).send()\n  }\n\n  @httpGet('/accept')\n  async accept(request: any, response: any) {\n    const { idUser } = request._user;\n    const { candidateFriendId } = request.query;\n\n    await Friend.findOneAndUpdate(\n      { requester: idUser, recipient: candidateFriendId },\n      { $set: { status: 3 } }\n    )\n    await Friend.findOneAndUpdate(\n      { recipient: idUser, requester: candidateFriendId },\n      { $set: { status: 3 } }\n    )\n\n    return response.status(204).send()\n  }\n\n  @httpGet('/reject')\n  async reject(request: any, response: any) {\n    const { idUser } = request._user;\n    const { candidateFriendId } = request.query;\n\n    const docA = await Friend.findOneAndRemove(\n      { requester: idUser, recipient: candidateFriendId }\n    )\n    const docB = await Friend.findOneAndRemove(\n      { recipient: idUser, requester: candidateFriendId }\n    )\n\n    if (docA?._id && docB?._id) {\n      \n      const updateUserA = await User.findOneAndUpdate(\n        { _id: idUser },\n        { $pull: { friends: docA._id } }\n      )\n      const updateUserB = await User.findOneAndUpdate(\n        { _id: candidateFriendId },\n        { $pull: { friends: docB._id } }\n      )\n\n      return response.status(204).send()\n    }\n\n    \n    return response.status(500).send()\n  }\n\n}\n\n\nexport const friendsController = new FriendsController()\n","module.exports = require(\"socket.io\");","import { Container, inject, injectable } from \"inversify\";\nimport * as http from \"http\";\n// import * as socketIo from 'socket.io'\nimport * as socketIo from 'socket.io';\nimport { TYPES } from \"../interfaces\";\nimport { myContainer } from \"../containerDI\";\nimport { Room } from \"../models/Room\";\nimport mongoose from \"mongoose\";\n\n\n@injectable()\nexport class WsServer {\n  private server!: socketIo.Server\n  private app!: http.Server\n\n  constructor(@inject(TYPES.Ws) private ws: typeof socketIo.Server) {\n    const app: http.Server = myContainer.get(TYPES.App)\n    \n    this.app = app\n    this.server = new ws(app, {\n      // Socket.IO options\n      // transports: [\"websocket\"]\n    });\n    // console.log(this.server)\n    // this.server.on('request', this.app as any)\n \n  }\n\n \n\n  public joinToRoom(roomID: string, userID: string) {\n    // this.server.on('connection', (socket) => {\n    //   // socket.emit('news', { hello: 'world' });\n    //   socket.broadcast.emit('chat');\n    //   \n    //   // socket.on('news', function (data: any) {\n    //   //   socket.emit('news', data);\n    //   // });\n    // });\n    this.server.once('connection', async (socket) => {\n      // debugger\n      // console.log(socket)\n      console.log(`${userID} user connected`);\n      // const idRoom = ''\n      let usersTyping: {[key: string]: string[]} = {}\n \n      const roomMsg = await Room.findOne({ _id: roomID })\n      this.server.emit(`chat:${roomID}:created`, roomMsg?.toObject().messages)\n      \n      socket.on(`chat:${roomID}`, async (msg) => {\n        const newMsg = {\n          msg,\n          author: new mongoose.Types.ObjectId(userID),\n          date: new Date(),\n        }\n        await Room.updateOne({ _id: roomID }, {\n          \"$push\": {\n            \"messages\": newMsg\n          }\n        })\n        \n        this.server.emit(`chat:${roomID}`, newMsg);\n      });\n      socket.on(`chat:${roomID}:typing`, (user: string) => {\n \n        if (!usersTyping[roomID]) {\n          usersTyping[roomID] = []\n        }\n        usersTyping[roomID] = [...new Set([...usersTyping[roomID], user])]\n        console.log(`${user} typing`);\n        console.log(usersTyping)\n        this.server.emit(`chat:${roomID}:typing`, usersTyping[roomID]); \n      });\n\n      socket.on(`chat:${roomID}:cancelTyping`, () => {\n        usersTyping[roomID] = usersTyping[roomID].filter(userType => userID !== userType)\n        this.server.emit(`chat:${roomID}:typing`, usersTyping[roomID]);  \n      });\n\n\n      // socket.on(`chat:${roomID}:cancelTyping`, (user: string) => {\n      //   usersTyping = usersTyping.filter(userType => user !== userType)\n      //   console.log(`${user} typing`);\n      //   this.server.emit(`chat:${roomID}:typing`, usersTyping); \n      // });\n  \n      socket.on('disconnect', () => { \n        console.log(`${userID} user disconnected`);\n        this.server.emit(`disconnect:${roomID}`, `${userID} user disconnected`); \n      });\n    });\n  }\n\n}\n","\nimport { User } from \"../models/User\";\nimport { updateUser } from \"../utils/base\";\n\n\nimport { controller, httpPatch, httpGet, httpDelete } from \"inversify-express-utils\";\nimport { authMiddleWare } from \"../middleware/authMiddleware\";\nimport { Friend } from \"../models/Friend\";\nimport { Room } from \"../models/Room\";\nimport mongoose from \"mongoose\";\nimport { myContainer } from \"../containerDI\";\nimport { TYPES } from \"../interfaces\";\nimport { WsServer } from \"../modules/WsServer\";\n\n@controller(\"/api/room\", authMiddleWare)\nexport class RoomController {\n\n  @httpGet('/createRoom')\n  async createRoom(request: any, response: any) {\n\n    const { idUser } = request._user;\n    // const { candidateFriendId } = request.query;\n    \n    const room = new Room({\n      admin: new mongoose.Types.ObjectId(idUser),\n      users: [new mongoose.Types.ObjectId(idUser)],\n      messages: []\n    }) \n\n    await room.save()\n    \n    \n    return response.json(room.toObject())\n  }\n\n  @httpGet('/getRooms')\n  async getRooms(request: any, response: any) {\n\n    const { idUser } = request._user;\n    // const { candidateFriendId } = request.query;\n    \n    const rooms = await Room.find({ \"users\": new mongoose.Types.ObjectId(idUser) })\n    \n    return response.json(rooms)\n  }\n\n  @httpGet('/setUserInRoom')\n  async setUserInRoom(request: any, response: any) {\n\n    const { idUser } = request._user;\n    const { friendId } = request.query;\n    const { roomId } = request.query;\n    \n    const updatedRoom = await Room.updateOne({_id: roomId}, {\n      \"$push\": {\n          \"users\": friendId\n      }}\n    )\n    \n    \n    return response.json(updatedRoom)\n  }\n\n  @httpGet('/joinToRoom')\n  async joinToRoom(request: any, response: any) {\n\n    const { idUser } = request._user; \n    const { roomID } = request.query;\n  \n    const ws = myContainer.get<WsServer>(TYPES.WsServer)\n    \n    ws.joinToRoom(roomID, idUser)\n\n    return response.send('ok')\n  }\n\n  @httpDelete('/deleteRoom')\n  async deleteRoom(request: any, response: any) {\n\n    const { idUser } = request._user; \n    const { roomID } = request.query;\n  \n    \n    const rooms = await Room.findOneAndDelete({_id: roomID},{ new: true })\n\n    return response.json(rooms)\n  }\n\n}\n\n\nexport const roomController = new RoomController()\n","module.exports = require(\"cors\");"],"sourceRoot":""}